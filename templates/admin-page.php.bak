<?php
/**
 * Template para a página de administração do LLMS.txt Generator
 *
 * @package LLMS_Txt_Generator
 * @since 1.0.0
 * @author Dante Testa (https://dantetesta.com.br)
 */

// Evitar acesso direto ao arquivo
if (!defined('ABSPATH')) {
    exit;
}

// Obter configurações
$admin = LLMS_Txt_Admin::get_instance();
$settings = $admin->get_settings();
$file_manager = LLMS_Txt_File::get_instance();
$post_types = $admin->get_available_post_types();
?>

<div class="wrap llms-admin-page">
    <!-- Sistema de notificações toast -->
    <div id="llms-toast-container" class="fixed top-4 right-4 z-50 w-80 max-w-full" style="transform: translateX(110%); transition: transform 0.3s ease-in-out;"></div>
    
    <div class="flex items-center justify-between mb-6">
        <h1 class="text-2xl font-bold m-0"><?php echo esc_html(get_admin_page_title()); ?></h1>
        
        <div class="flex items-center space-x-2">
            <?php if ($file_manager->file_exists()): ?>
                <a href="<?php echo esc_url($file_manager->get_file_url()); ?>" target="_blank" class="inline-flex items-center bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition duration-150 ease-in-out">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z" />
                    </svg>
                    <?php _e('Ver arquivo llms.txt', 'llms-txt-generator'); ?>
                </a>
            <?php endif; ?>
            
            <button type="button" id="llms_txt_regenerate_file" class="inline-flex items-center bg-yellow-500 hover:bg-yellow-600 text-white font-medium py-2 px-4 rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-yellow-500 transition duration-150 ease-in-out">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" />
                </svg>
                <?php _e('Regenerar arquivo', 'llms-txt-generator'); ?>
            </button>
        </div>
    </div>
    
    <div class="bg-white shadow-sm rounded-lg border border-gray-200 overflow-hidden">

        <form method="post" action="options.php">
            <?php settings_fields('llms_txt_settings'); ?>
            
            <!-- Cabeçalho da página -->
            <div class="border-b border-gray-200 bg-gray-50 p-6">
                <div class="flex flex-col md:flex-row md:items-center md:justify-between">
                    <div>
                        <h2 class="text-xl font-bold text-gray-800"><?php _e('Configurações do LLMS.txt Generator', 'llms-txt-generator'); ?></h2>
                        <p class="mt-1 text-sm text-gray-600"><?php _e('Configure como o arquivo llms.txt será gerado para informar às Inteligências Artificiais sobre o conteúdo do seu site.', 'llms-txt-generator'); ?></p>
                    </div>
                    
                    <div class="mt-4 md:mt-0">
                        <label for="llms_txt_enabled" class="flex items-center cursor-pointer toggle-label" role="switch" aria-checked="<?php echo ($settings['enabled'] === '1') ? 'true' : 'false'; ?>" tabindex="0">
                            <span class="relative inline-block w-14 h-8 transition duration-200 ease-in-out">
                                <input type="checkbox" id="llms_txt_enabled" name="llms_txt_settings[enabled]" value="1" <?php checked('1', $settings['enabled']); ?> class="sr-only toggle-checkbox">
                                <span class="block w-14 h-8 <?php echo ($settings['enabled'] === '1') ? 'bg-blue-500' : 'bg-gray-300'; ?> rounded-full shadow-inner toggle-bg"></span>
                                <span class="toggle-dot absolute left-1 top-1 bg-white w-6 h-6 rounded-full transition-transform duration-300 ease-in-out transform <?php echo ($settings['enabled'] === '1') ? 'translate-x-6' : ''; ?>"></span>
                            </span>
                            <span class="ml-3 text-sm font-medium text-gray-700">
                                <?php _e('Habilitar arquivo llms.txt', 'llms-txt-generator'); ?>
                            </span>
                        </label>
                        <p class="mt-1 text-xs text-gray-500">
                            <?php _e('Quando habilitado, o arquivo llms.txt será gerado e disponibilizado na raiz do seu site.', 'llms-txt-generator'); ?>
                        </p>
                    </div>
                </div>
            </div>
            
            <!-- Layout de duas colunas -->
            <div class="p-6 grid grid-cols-1 md:grid-cols-3 gap-6">
            
                <!-- Coluna Esquerda -->
                <div class="col-span-1 md:col-span-2">
                    <div class="bg-white rounded-lg border border-gray-200 shadow-sm overflow-hidden">
                        <div class="border-b border-gray-200 bg-gray-50 px-4 py-3">
                            <h3 class="text-lg font-medium text-gray-800"><?php _e('Descrição do Site', 'llms-txt-generator'); ?></h3>
                        </div>
                        <div class="p-4">
                            <p class="text-sm text-gray-600 mb-3">
                                <?php _e('Adicione uma descrição personalizada para o seu site no arquivo llms.txt.', 'llms-txt-generator'); ?>
                            </p>
                            <textarea 
                                id="llms_txt_site_description" 
                                name="llms_txt_settings[site_description]" 
                                rows="4" 
                                class="w-full px-3 py-2 text-gray-700 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 resize-y"
                                placeholder="<?php _e('Descreva o propósito do seu site...', 'llms-txt-generator'); ?>"
                            ><?php echo esc_textarea(isset($settings['site_description']) ? $settings['site_description'] : ''); ?></textarea>
                            <p class="text-xs text-gray-500 mt-2">
                                <?php _e('Esta descrição será exibida logo após o título do site no arquivo llms.txt.', 'llms-txt-generator'); ?>
                            </p>
                        </div>
                    </div>
            
                    <div class="bg-white rounded-lg border border-gray-200 shadow-sm overflow-hidden mt-6">
                        <div class="border-b border-gray-200 bg-gray-50 px-4 py-3">
                            <h3 class="text-lg font-medium text-gray-800"><?php _e('Conteúdo a Incluir', 'llms-txt-generator'); ?></h3>
                        </div>
                        <div class="p-4">
                            <p class="text-sm text-gray-600 mb-4">
                                <?php _e('Selecione quais tipos de conteúdo devem ser incluídos no arquivo llms.txt.', 'llms-txt-generator'); ?>
                            </p>
                            
                            <div class="mb-4 flex items-center">
                                <label for="llms_txt_include_pages" class="flex items-center cursor-pointer">
                                    <div class="relative">
                                        <input type="checkbox" id="llms_txt_include_pages" name="llms_txt_settings[include_pages]" value="1" <?php checked('1', isset($settings['include_pages']) ? $settings['include_pages'] : '0'); ?> class="toggle-checkbox sr-only">
                                        <div class="w-12 h-6 bg-gray-200 rounded-full shadow-inner toggle-bg"></div>
                                        <div class="toggle-dot absolute w-6 h-6 bg-white rounded-full shadow-md top-0 left-0 transition-transform duration-300 ease-in-out <?php echo (isset($settings['include_pages']) && $settings['include_pages'] === '1') ? 'transform translate-x-6' : ''; ?>"></div>
                                    </div>
                                    <div class="ml-3 text-sm font-medium text-gray-700">
                                        <?php _e('Incluir páginas', 'llms-txt-generator'); ?>
                                    </div>
                                </label>
                            </div>
                            
                            <h4 class="text-md font-medium text-gray-700 mb-3 border-b border-gray-200 pb-2"><?php _e('Tipos de Post Adicionais', 'llms-txt-generator'); ?></h4>
                            
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
                                <?php 
                                // Remover post e page, pois já são tratados separadamente
                                $custom_post_types = $post_types;
                                unset($custom_post_types['post']);
                                unset($custom_post_types['page']);
                                
                                foreach ($custom_post_types as $type => $label): ?>
                                    <div class="flex items-center">
                                        <input type="checkbox" id="llms_txt_post_type_<?php echo esc_attr($type); ?>" 
                                            name="llms_txt_settings[post_types][]" 
                                            value="<?php echo esc_attr($type); ?>" 
                                            <?php checked(in_array($type, isset($settings['post_types']) ? $settings['post_types'] : array())); ?> 
                                            class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded">
                                        <label for="llms_txt_post_type_<?php echo esc_attr($type); ?>" class="ml-2 block text-sm font-medium text-gray-700">
                                            <?php echo esc_html($label); ?>
                                        </label>
                                    </div>
                                <?php endforeach; ?>
                            </div>
                        </div>
                    </div>
            
                    <div class="bg-white rounded-lg border border-gray-200 shadow-sm overflow-hidden mt-6">
                        <div class="border-b border-gray-200 bg-gray-50 px-4 py-3">
                            <h3 class="text-lg font-medium text-gray-800"><?php _e('Conteúdo Personalizado', 'llms-txt-generator'); ?></h3>
                        </div>
                        <div class="p-4">
                            <p class="text-sm text-gray-600 mb-3">
                                <?php _e('Adicione conteúdo personalizado para o arquivo llms.txt. Use o formato Markdown.', 'llms-txt-generator'); ?>
                            </p>
                            <div class="bg-gray-50 border border-gray-200 rounded-md p-3 mb-3">
                                <textarea 
                                    id="llms_txt_custom_content" 
                                    name="llms_txt_settings[custom_content]" 
                                    rows="8" 
                                    class="w-full px-3 py-2 text-gray-700 bg-white border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 resize-y font-mono text-sm"
                                    placeholder="<?php _e('## Projetos\n\n- [Projeto A](https://exemplo.com/projeto-a): Descrição do projeto A\n- [Projeto B](https://exemplo.com/projeto-b): Descrição do projeto B', 'llms-txt-generator'); ?>"
                                ><?php echo esc_textarea(isset($settings['custom_content']) ? $settings['custom_content'] : ''); ?></textarea>
                            </div>
                            <div class="bg-blue-50 border-l-4 border-blue-400 p-3 rounded">
                                <div class="flex">
                                    <div class="flex-shrink-0">
                                        <svg class="h-5 w-5 text-blue-400" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd" />
                                        </svg>
                                    </div>
                                    <div class="ml-3">
                                        <p class="text-sm text-blue-700">
                                            <?php _e('Exemplo de formato Markdown para conteúdo personalizado:', 'llms-txt-generator'); ?>
                                            <br>
                                            <code class="text-xs bg-blue-100 px-1 py-0.5 rounded">## Projetos</code><br>
                                            <code class="text-xs bg-blue-100 px-1 py-0.5 rounded">- [Projeto A](https://exemplo.com/projeto-a): Descrição do projeto A</code><br>
                                            <code class="text-xs bg-blue-100 px-1 py-0.5 rounded">- [Projeto B](https://exemplo.com/projeto-b): Descrição do projeto B</code>
                                        </p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            
                <!-- Coluna Direita -->
                <div class="col-span-1">
                    <div class="bg-white rounded-lg border border-gray-200 shadow-sm overflow-hidden">
                        <div class="border-b border-gray-200 bg-gray-50 px-4 py-3">
                            <h3 class="text-lg font-medium text-gray-800"><?php _e('Integração com IA', 'llms-txt-generator'); ?></h3>
                        </div>
                        <div class="p-4">
                            <p class="text-sm text-gray-600 mb-4">
                                <?php _e('Configure a integração com APIs de Inteligência Artificial para gerar descrições técnicas automaticamente.', 'llms-txt-generator'); ?>
                            </p>
                            
                            <!-- Seleção de Provedor de IA -->
                            <div class="mb-6 bg-blue-50 rounded-lg p-4 border border-blue-100">
                                <label class="block text-sm font-medium text-gray-700 mb-2">
                                    <?php _e('Provedor de IA', 'llms-txt-generator'); ?>
                                </label>
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                    <!-- OpenAI Card -->
                                    <label class="provider-card relative flex flex-col bg-white p-4 border rounded-lg cursor-pointer hover:bg-gray-50 transition-all duration-200 <?php echo (isset($settings['ai_provider']) && $settings['ai_provider'] === 'openai') || !isset($settings['ai_provider']) ? 'border-blue-500 ring-2 ring-blue-200' : 'border-gray-200'; ?>">
                                        <input type="radio" name="llms_txt_settings[ai_provider]" value="openai" class="provider-radio sr-only" <?php checked(isset($settings['ai_provider']) ? $settings['ai_provider'] : 'openai', 'openai'); ?>>
                                        <div class="flex items-center">
                                            <div class="flex-shrink-0 bg-gradient-to-r from-green-400 to-blue-500 p-2 rounded-full">
                                                <svg class="w-6 h-6 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z" />
                                                </svg>
                                            </div>
                                            <div class="ml-3">
                                                <span class="block text-sm font-medium text-gray-900">OpenAI (ChatGPT)</span>
                                                <span class="block text-xs text-gray-500">API paga, resultados de alta qualidade</span>
                                            </div>
                                        </div>
                                        <!-- Indicador de seleção -->
                                        <div class="absolute top-2 right-2 w-4 h-4 bg-blue-500 rounded-full opacity-0 transition-opacity duration-200 check-indicator <?php echo (isset($settings['ai_provider']) && $settings['ai_provider'] === 'openai') || !isset($settings['ai_provider']) ? 'opacity-100' : ''; ?>"></div>
                                    </label>
                                    
                                    <!-- DeepSeek Card -->
                                    <label class="provider-card relative flex flex-col bg-white p-4 border rounded-lg cursor-pointer hover:bg-gray-50 transition-all duration-200 <?php echo (isset($settings['ai_provider']) && $settings['ai_provider'] === 'deepseek') ? 'border-blue-500 ring-2 ring-blue-200' : 'border-gray-200'; ?>">
                                        <input type="radio" name="llms_txt_settings[ai_provider]" value="deepseek" class="provider-radio sr-only" <?php checked(isset($settings['ai_provider']) ? $settings['ai_provider'] : '', 'deepseek'); ?>>
                                        <div class="flex items-center">
                                            <div class="flex-shrink-0 bg-gradient-to-r from-purple-400 to-indigo-500 p-2 rounded-full">
                                                <svg class="w-6 h-6 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4" />
                                                </svg>
                                            </div>
                                            <div class="ml-3">
                                                <span class="block text-sm font-medium text-gray-900">DeepSeek Chat v3</span>
                                                <span class="block text-xs text-gray-500">Via OpenRouter, opção gratuita</span>
                                            </div>
                                        </div>
                                        <!-- Indicador de seleção -->
                                        <div class="absolute top-2 right-2 w-4 h-4 bg-blue-500 rounded-full opacity-0 transition-opacity duration-200 check-indicator <?php echo (isset($settings['ai_provider']) && $settings['ai_provider'] === 'deepseek') ? 'opacity-100' : ''; ?>"></div>
                                    </label>
                                </div>
                                
                                <div class="mt-3 text-xs text-gray-600">
                                    <p class="mb-1">
                                        <strong><?php _e('Links úteis:', 'llms-txt-generator'); ?></strong>
                                    </p>
                                    <div class="flex flex-wrap gap-2">
                                        <a href="https://platform.openai.com/docs/guides/text-generation" target="_blank" class="inline-flex items-center text-blue-600 hover:text-blue-800 hover:underline">
                                            <svg class="w-3 h-3 mr-1" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14" />
                                            </svg>
                                            <?php _e('Manual da API OpenAI', 'llms-txt-generator'); ?>
                                        </a>
                                        <span class="text-gray-400">|</span>
                                        <a href="https://openrouter.ai/docs" target="_blank" class="inline-flex items-center text-blue-600 hover:text-blue-800 hover:underline">
                                            <svg class="w-3 h-3 mr-1" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14" />
                                            </svg>
                                            <?php _e('Manual da API OpenRouter (DeepSeek Chat v3)', 'llms-txt-generator'); ?>
                                        </a>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- OpenAI API Key -->
                            <div class="mb-6 openai-api-fields" data-provider="openai" style="<?php echo (isset($settings['ai_provider']) && $settings['ai_provider'] !== 'openai') ? 'display: none;' : ''; ?>">
                                <div class="bg-white border border-gray-200 rounded-lg p-4">
                                    <label for="llms_txt_openai_api_key" class="block text-sm font-medium text-gray-700 mb-2">
                                        <?php _e('Chave da API OpenAI', 'llms-txt-generator'); ?>
                                    </label>
                                    <div class="relative">
                                        <input 
                                            type="password" 
                                            id="llms_txt_openai_api_key" 
                                            name="llms_txt_settings[openai_api_key]" 
                                            value="<?php echo esc_attr(isset($settings['openai_api_key']) ? $settings['openai_api_key'] : ''); ?>" 
                                            class="w-full px-3 py-2 pr-16 md:pr-28 text-gray-700 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                                            placeholder="<?php _e('Insira sua chave API OpenAI', 'llms-txt-generator'); ?>"
                                        >
                                        <button 
                                            type="button" 
                                            class="password-toggle absolute inset-y-0 right-0 px-3 py-2 text-sm font-medium text-blue-600 hover:text-blue-800 focus:outline-none flex items-center transition-colors duration-200 bg-gray-50 border-l border-gray-300 rounded-r-md"
                                            aria-label="<?php _e('Alternar visibilidade da chave', 'llms-txt-generator'); ?>"
                                            data-target="llms_txt_openai_api_key"
                                        >
                                            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z" />
                                            </svg>
                                            <span class="toggle-text whitespace-nowrap inline"><?php _e('Mostrar', 'llms-txt-generator'); ?></span>
                                        </button>
                                    </div>
                                    <p class="text-xs text-gray-500 mt-2">
                                        <?php _e('Necessária para gerar descrições técnicas automaticamente com a OpenAI.', 'llms-txt-generator'); ?>
                                    </p>
                                    <div class="mt-3 flex flex-wrap items-center gap-2">
                                        <button 
                                            type="button" 
                                            id="llms_txt_validate_openai_api_key" 
                                            class="inline-flex items-center bg-green-500 hover:bg-green-600 text-white font-medium py-2 px-3 text-sm rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 transition duration-150 ease-in-out"
                                            aria-label="<?php _e('Validar chave API OpenAI', 'llms-txt-generator'); ?>"
                                        >
                                            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                                            </svg>
                                            <span><?php _e('Validar Chave', 'llms-txt-generator'); ?></span>
                                        </button>
                                        <span id="llms_txt_openai_api_key_status" class="text-sm font-medium"></span>
                                    </div>
                                    <div class="mt-2 text-xs">
                                        <a href="https://platform.openai.com/api-keys" target="_blank" class="text-blue-600 hover:text-blue-800 hover:underline inline-flex items-center">
                                            <svg class="w-3 h-3 mr-1" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14" />
                                            </svg>
                                            <?php _e('Obter chave da API OpenAI', 'llms-txt-generator'); ?>
                                        </a>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- DeepSeek API Key -->
                            <div class="mb-6 deepseek-api-fields" data-provider="deepseek" style="<?php echo (!isset($settings['ai_provider']) || $settings['ai_provider'] !== 'deepseek') ? 'display: none;' : ''; ?>">
                                <div class="bg-white border border-gray-200 rounded-lg p-4">
                                    <label for="llms_txt_deepseek_api_key" class="block text-sm font-medium text-gray-700 mb-2">
                                        <?php _e('Chave da API OpenRouter (DeepSeek Chat v3)', 'llms-txt-generator'); ?>
                                    </label>
                                    <div class="relative">
                                        <input 
                                            type="password" 
                                            id="llms_txt_deepseek_api_key" 
                                            name="llms_txt_settings[deepseek_api_key]" 
                                            value="<?php echo esc_attr(isset($settings['deepseek_api_key']) ? $settings['deepseek_api_key'] : ''); ?>" 
                                            class="w-full px-3 py-2 pr-16 md:pr-28 text-gray-700 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                                            placeholder="<?php _e('Insira sua chave API OpenRouter', 'llms-txt-generator'); ?>"
                                        >
                                        <button 
                                            type="button" 
                                            class="password-toggle absolute inset-y-0 right-0 px-3 py-2 text-sm font-medium text-blue-600 hover:text-blue-800 focus:outline-none flex items-center transition-colors duration-200 bg-gray-50 border-l border-gray-300 rounded-r-md"
                                            aria-label="<?php _e('Alternar visibilidade da chave', 'llms-txt-generator'); ?>"
                                            data-target="llms_txt_deepseek_api_key"
                                        >
                                            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z" />
                                            </svg>
                                            <span class="toggle-text whitespace-nowrap inline"><?php _e('Mostrar', 'llms-txt-generator'); ?></span>
                                        </button>
                                    </div>
                                    <p class="text-xs text-gray-500 mt-2">
                                        <?php _e('Necessária para usar o modelo DeepSeek Chat v3 (gratuito).', 'llms-txt-generator'); ?>
                                    </p>
                                    <div class="mt-3 flex flex-wrap items-center gap-2">
                                        <button 
                                            type="button" 
                                            id="llms_txt_validate_deepseek_api_key" 
                                            class="inline-flex items-center bg-green-500 hover:bg-green-600 text-white font-medium py-2 px-3 text-sm rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 transition duration-150 ease-in-out"
                                            aria-label="<?php _e('Validar chave API OpenRouter', 'llms-txt-generator'); ?>"
                                        >
                                            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                                            </svg>
                                            <span><?php _e('Validar Chave', 'llms-txt-generator'); ?></span>
                                        </button>
                                        <span id="llms_txt_deepseek_api_key_status" class="text-sm font-medium"></span>
                                    </div>
                                    <div class="mt-2 text-xs">
                                        <a href="https://openrouter.ai/keys" target="_blank" class="text-blue-600 hover:text-blue-800 hover:underline inline-flex items-center">
                                            <svg class="w-3 h-3 mr-1" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14" />
                                            </svg>
                                            <?php _e('Obter chave gratuita da API OpenRouter', 'llms-txt-generator'); ?>
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
            
                    <div class="bg-white rounded-lg border border-gray-200 shadow-sm overflow-hidden mt-6">
                        <div class="border-b border-gray-200 bg-gray-50 px-4 py-3">
                            <h3 class="text-lg font-medium text-gray-800"><?php _e('Visualização do arquivo llms.txt', 'llms-txt-generator'); ?></h3>
                        </div>
                        <div class="p-4">
                            <div class="mb-4 flex space-x-2">
                                <button 
                                    type="button" 
                                    id="llms_txt_preview_file" 
                                    class="inline-flex items-center bg-blue-500 hover:bg-blue-600 text-white font-medium py-2 px-4 rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition duration-150 ease-in-out"
                                >
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z" />
                                    </svg>
                                    <?php _e('Visualizar arquivo', 'llms-txt-generator'); ?>
                                </button>
                                
                                <button 
                                    type="button" 
                                    id="llms_txt_regenerate_file" 
                                    class="inline-flex items-center bg-yellow-500 hover:bg-yellow-600 text-white font-medium py-2 px-4 rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-yellow-500 transition duration-150 ease-in-out"
                                >
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" />
                                    </svg>
                                    <?php _e('Regenerar arquivo', 'llms-txt-generator'); ?>
                                </button>
                            </div>
                            
                            <div id="llms_txt_preview_container" class="hidden">
                                <div class="bg-gray-50 border border-gray-200 rounded-md">
                                    <div class="bg-gray-100 border-b border-gray-200 px-3 py-2 flex justify-between items-center">
                                        <span class="text-xs font-medium text-gray-600">llms.txt</span>
                                        <span class="text-xs text-gray-500"><?php echo $file_manager->get_last_updated(); ?></span>
                                    </div>
                                    <pre id="llms_txt_preview_content" class="p-4 overflow-x-auto text-sm font-mono text-gray-700 max-h-80"></pre>
                                </div>
                            </div>
                            
                            <?php if (!empty($settings['last_updated'])): ?>
                                <div class="flex items-center mt-4 text-sm text-gray-500">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
                                    </svg>
                                    <?php printf(__('Última atualização: %s', 'llms-txt-generator'), $file_manager->get_last_updated()); ?>
                                </div>
                            <?php endif; ?>
                        </div>
                    </div>
                </div>
        
                <!-- Botões de ação -->
                <div class="p-6 border-t border-gray-200 bg-gray-50 flex justify-center sm:justify-end">
                    <button type="submit" class="inline-flex items-center bg-gradient-to-r from-blue-600 to-blue-800 hover:from-blue-700 hover:to-blue-900 text-white font-medium py-3 px-8 rounded-lg shadow-md hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-all duration-300 ease-in-out transform hover:scale-105">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
            <h3 class="text-lg font-medium text-gray-800"><?php _e('Sobre o LLMS.txt Generator', 'llms-txt-generator'); ?></h3>
        </div>
        <div class="p-6">
            <div class="flex flex-col md:flex-row md:space-x-4">
                <div class="flex-shrink-0 mb-4 md:mb-0">
                    <div class="bg-blue-100 rounded-full p-3">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-blue-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                        </svg>
                    </div>
                </div>
                <div>
                    <p class="text-gray-600 mb-3">
                        <?php _e('O arquivo llms.txt é um formato que permite informar às Inteligências Artificiais sobre o conteúdo do seu site de forma estruturada.', 'llms-txt-generator'); ?>
                    </p>
                    <p class="text-gray-600 mb-3">
                        <?php _e('Similar ao robots.txt, ele permite que você especifique quais partes do seu site podem ou não ser acessadas por IAs para treinamento ou geração de conteúdo.', 'llms-txt-generator'); ?>
                    </p>
                    <p class="text-gray-600 mb-3">
                        <?php _e('Para mais informações, visite', 'llms-txt-generator'); ?> <a href="https://llms.txt.org" target="_blank" class="text-blue-600 hover:text-blue-800 font-medium">llms.txt.org</a>.
                    </p>
                    
                    <!-- Informações do autor -->
                    <div class="mt-6 pt-6 border-t border-gray-200">
                        <h4 class="text-base font-medium text-gray-800 mb-3"><?php _e('Desenvolvido por', 'llms-txt-generator'); ?></h4>
                        <div class="flex items-center mb-3">
                            <img src="https://www.gravatar.com/avatar/<?php echo md5('dante.testa@gmail.com'); ?>?s=60&d=mp" alt="Dante Testa" class="w-12 h-12 rounded-full mr-3">
                            <div>
                                <p class="font-medium text-gray-900">Dante Testa</p>
                                <a href="https://dantetesta.com.br" target="_blank" class="text-blue-600 hover:text-blue-800 text-sm">www.dantetesta.com.br</a>
                                <p class="text-sm text-gray-600">WhatsApp: +55 19 99802-1956</p>
                            </div>
                        </div>
                        
                        <!-- Seção de doação -->
                        <div class="mt-4 p-4 bg-gradient-to-r from-blue-50 to-indigo-50 rounded-lg">
                            <h4 class="text-base font-medium text-gray-800 mb-2"><?php _e('Gostou desse plugin?', 'llms-txt-generator'); ?></h4>
                            <p class="text-sm text-gray-600 mb-3"><?php _e('Doe qualquer quantia para ajudar a manter ele atualizado e disponível no WordPress.', 'llms-txt-generator'); ?></p>
                            <div class="flex flex-wrap gap-3">
                                <a href="https://www.paypal.com/donate?hosted_button_id=dante.testa@gmail.com" target="_blank" class="inline-flex items-center px-4 py-2 bg-blue-500 hover:bg-blue-600 text-white text-sm font-medium rounded-md transition-colors duration-300">
                                    <svg class="w-4 h-4 mr-2" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M20.067 8.478c.492.88.556 2.014.3 3.327-.74 3.806-3.276 5.12-6.514 5.12h-.5a.805.805 0 0 0-.794.68l-.04.22-.63 4.876-.03.05a.798.798 0 0 1-.79.68h-2.984a.5.5 0 0 1-.496-.55l.02-.124.03-.154.794-5.055a.992.992 0 0 1 .98-.827h2.7c3.278 0 6.092-1.556 6.885-5.443l.025-.118c.186-.824.187-1.54.044-2.15-.12-.517-.332-.945-.63-1.296a3.49 3.49 0 0 0-.856-.63c.388.132.717.302.984.513.418.337.717.738.9 1.162z"/>
                                        <path d="M18.768 6.66a5.175 5.175 0 0 0-.582-.425 4.778 4.778 0 0 0-.97-.445 6.695 6.695 0 0 0-1.696-.305h-5.669a.992.992 0 0 0-.981.8l-2.665 16.88a.5.5 0 0 0 .49.59h2.998a.801.801 0 0 0 .79-.68l.04-.22.793-5.05a.805.805 0 0 1 .793-.681h.5c3.24 0 5.776-1.314 6.514-5.12.255-1.313.19-2.447-.3-3.327-.184-.424-.483-.825-.9-1.162a3.546 3.546 0 0 0-.984-.513 3.49 3.49 0 0 0-.856-.63c-.294-.151-.62-.277-.97-.377a7.57 7.57 0 0 0-1.945-.269H8.674a.797.797 0 0 0-.79.676l-1.97 12.476a.37.37 0 0 1-.365.314H2.564a.37.37 0 0 1-.365-.426l1.97-12.476a.798.798 0 0 1 .79-.677h8.013c1.153 0 2.153.26 2.914.778.384.262.692.585.915.964.223.38.356.803.396 1.273a3.69 3.69 0 0 1-.93 2.884 5.204 5.204 0 0 1-4.067 1.717H9.6a.798.798 0 0 0-.79.677l-1.97 12.476a.37.37 0 0 1-.365.314H3.49a.37.37 0 0 1-.365-.426l1.97-12.476a.798.798 0 0 1 .79-.677h8.013c1.153 0 2.153.26 2.914.778.384.262.692.585.915.964.223.38.356.803.396 1.273.04.47-.04.982-.24 1.546-.2.564-.5 1.07-.9 1.517-.4.446-.9.803-1.5 1.07-.6.268-1.3.402-2.1.402h-2.574a.798.798 0 0 0-.79.677l-1.97 12.476a.37.37 0 0 1-.365.314H3.49a.37.37 0 0 1-.365-.426l1.97-12.476a.798.798 0 0 1 .79-.677h8.013c1.153 0 2.153.26 2.914.778.384.262.692.585.915.964.223.38.356.803.396 1.273.04.47-.04.982-.24 1.546-.2.564-.5 1.07-.9 1.517-.4.446-.9.803-1.5 1.07-.6.268-1.3.402-2.1.402h-2.574a.798.798 0 0 0-.79.677l-1.97 12.476a.37.37 0 0 1-.365.314H3.49a.37.37 0 0 1-.365-.426l1.97-12.476a.798.798 0 0 1 .79-.677h8.013c1.153 0 2.153.26 2.914.778.384.262.692.585.915.964.223.38.356.803.396 1.273.04.47-.04.982-.24 1.546-.2.564-.5 1.07-.9 1.517-.4.446-.9.803-1.5 1.07-.6.268-1.3.402-2.1.402h-2.574a.798.798 0 0 0-.79.677l-1.97 12.476a.37.37 0 0 1-.365.314H3.49a.37.37 0 0 1-.365-.426l1.97-12.476a.798.798 0 0 1 .79-.677h8.013c1.153 0 2.153.26 2.914.778.384.262.692.585.915.964.223.38.356.803.396 1.273.04.47-.04.982-.24 1.546-.2.564-.5 1.07-.9 1.517-.4.446-.9.803-1.5 1.07-.6.268-1.3.402-2.1.402h-2.574a.798.798 0 0 0-.79.677l-1.97 12.476a.37.37 0 0 1-.365.314H3.49a.37.37 0 0 1-.365-.426l1.97-12.476a.798.798 0 0 1 .79-.677h8.013c1.153 0 2.153.26 2.914.778.384.262.692.585.915.964.223.38.356.803.396 1.273.04.47-.04.982-.24 1.546-.2.564-.5 1.07-.9 1.517-.4.446-.9.803-1.5 1.07-.6.268-1.3.402-2.1.402h-2.574a.798.798 0 0 0-.79.677l-1.97 12.476a.37.37 0 0 1-.365.314H3.49a.37.37 0 0 1-.365-.426l1.97-12.476a.798.798 0 0 1 .79-.677h8.013c1.153 0 2.153.26 2.914.778.384.262.692.585.915.964.223.38.356.803.396 1.273"/>
                                    </svg>
                                    PayPal
                                </a>
                                <div class="inline-flex items-center px-4 py-2 bg-green-500 hover:bg-green-600 text-white text-sm font-medium rounded-md transition-colors duration-300">
                                    <svg class="w-4 h-4 mr-2" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M11.9999 2C6.47774 2 2.00002 6.47771 2.00002 12C2.00002 17.5223 6.47774 22 11.9999 22C17.5222 22 21.9999 17.5223 21.9999 12C21.9999 6.47771 17.5222 2 11.9999 2ZM15.7361 8.56717C15.7361 8.56717 15.9382 8.52379 16.0446 8.63677C16.1509 8.74976 16.1446 8.97471 16.1446 8.97471C16.1446 8.97471 16.1321 9.87302 15.7612 9.98601C15.3904 10.099 15.1382 9.38908 15.1382 9.38908L15.1382 9.38908C15.1382 9.38908 15.0633 9.21647 15.0633 9.12433C15.0633 9.03219 15.1382 8.97471 15.1382 8.97471C15.1382 8.97471 15.3403 8.56717 15.7361 8.56717ZM8.26397 8.56717C8.65978 8.56717 8.86189 8.97471 8.86189 8.97471C8.86189 8.97471 8.93675 9.03219 8.93675 9.12433C8.93675 9.21647 8.86189 9.38908 8.86189 9.38908L8.86189 9.38908C8.86189 9.38908 8.60966 10.099 8.23886 9.98601C7.86806 9.87302 7.85552 8.97471 7.85552 8.97471C7.85552 8.97471 7.84925 8.74976 7.95552 8.63677C8.0618 8.52379 8.26397 8.56717 8.26397 8.56717ZM19.4999 11.9999C19.4999 16.1422 16.1422 19.4999 11.9999 19.4999C7.85761 19.4999 4.49995 16.1422 4.49995 11.9999C4.49995 11.6057 4.53217 11.2191 4.59395 10.8429C5.73217 11.0717 6.86806 10.0999 6.86806 10.0999L6.86806 10.0999C6.86806 10.0999 7.36806 9.59985 7.36806 9.09985C7.36806 8.59985 6.86806 8.09985 6.86806 8.09985C6.86806 8.09985 5.73217 7.12804 4.59395 7.35685C4.53217 6.98068 4.49995 6.59408 4.49995 6.19985C4.49995 6.19985 5.73217 6.09985 6.36806 5.59985C6.97919 5.12129 7.36806 3.69985 7.36806 3.69985C7.36806 3.69985 8.86806 4.09985 9.86806 4.09985C10.868 4.09985 11.9999 3.19985 11.9999 3.19985C11.9999 3.19985 13.1318 4.09985 14.1318 4.09985C15.1318 4.09985 16.6318 3.69985 16.6318 3.69985C16.6318 3.69985 17.0207 5.12129 17.6318 5.59985C18.2677 6.09985 19.4999 6.19985 19.4999 6.19985C19.4999 6.59408 19.4677 6.98068 19.4059 7.35685C18.2677 7.12804 17.1318 8.09985 17.1318 8.09985C17.1318 8.09985 16.6318 8.59985 16.6318 9.09985C16.6318 9.59985 17.1318 10.0999 17.1318 10.0999L17.1318 10.0999C17.1318 10.0999 18.2677 11.0717 19.4059 10.8429C19.4677 11.2191 19.4999 11.6057 19.4999 11.9999ZM15.9999 14.9999C15.9999 15.2761 15.7761 15.4999 15.4999 15.4999H8.49995C8.22381 15.4999 7.99995 15.2761 7.99995 14.9999V14.4999C7.99995 14.2238 8.22381 13.9999 8.49995 13.9999H15.4999C15.7761 13.9999 15.9999 14.2238 15.9999 14.4999V14.9999Z"/>
                                    </svg>
                                    PIX: dante.testa@gmail.com
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Rodapé -->
    <div class="mt-8 mb-4 text-center">
        <div class="inline-flex items-center justify-center bg-gray-100 rounded-full px-4 py-2">
            <span class="text-sm text-gray-600">
                <?php printf(__('LLMS.txt Generator v%s | Desenvolvido por', 'llms-txt-generator'), LLMS_TXT_GENERATOR_VERSION); ?> 
                <a href="https://dantetesta.com.br" target="_blank" class="text-blue-600 hover:text-blue-800 font-medium">Dante Testa</a>
            </span>
        </div>
    </div>
</div>

<!-- Script para notificações toast -->
<script>
    // Localize os dados para o script admin-page.js
    var llms_txt_admin = {
        nonce: '<?php echo wp_create_nonce("llms_txt_ajax_nonce"); ?>'
    };
</script>
<script src="<?php echo esc_url(plugin_dir_url(dirname(__FILE__)) . 'assets/js/admin-page.js'); ?>" defer></script>

<!-- Container para notificações toast -->
<div id="llms-txt-toast-container" class="fixed top-4 right-4 z-50 flex flex-col items-end space-y-2 transform transition-transform duration-300" style="transform: translateX(110%)"></div>

